{"name":"AutoInsClaims_csv_shaped_flow","description":"","pipeline":{"version":"1.0","doc_type":"pipeline","app_data":{"shaperCreated":true,"replace_space_by_dot":true},"primary_pipeline":"pipeline1","pipelines":[{"id":"pipeline1","nodes":[{"id":"source1","app_data":{"sampling":{"type":"topRows","size":10000}},"data_asset":{"properties":{"row_delimiter":"new_line","decimal_rounding_mode":"floor","first_line_header":"true","quote_character":"double_quote","encoding":"UTF-8","escape_character":"double_quote","field_delimiter":"comma","invalid_data_handling":"fail","file_format":"delimited","row_limit":"10000"},"ref":"d5955ae4-ba73-4901-a235-e5917e70260a","app_data":{"dataset_name":"AutoInsClaims_csv_shaped"}},"type":"binding","output":{"id":"source1output"}},{"id":"dc18e187-5775-4045-8f8e-77100805c4eb","type":"execution_node","op":"com.ibm.wdp.transformer.FreeformCode","app_data":{"uiParams":{"key":"mutate","code":"mutate(`INCIDENT_CAUSE` = as.integer(`INCIDENT_CAUSE`),`CLAIM_STATUS` = as.integer(`CLAIM_STATUS`),`ODOMETER_AT_LOSS` = as.double(`ODOMETER_AT_LOSS`),`LOSS_EVENT_TIME` = as.Date(lubridate::parse_date_time(`LOSS_EVENT_TIME`, \"ymd\", quiet=TRUE)),`CLAIM_INIT_TIME` = as.Date(lubridate::parse_date_time(`CLAIM_INIT_TIME`, \"ymd\", quiet=TRUE)),`POLICE_REPORT` = as.integer(`POLICE_REPORT`),`CLAIMS_AT_LOSS_DATE` = as.integer(`CLAIMS_AT_LOSS_DATE`),`LOSS_LOCATION_LAT` = as.double(`LOSS_LOCATION_LAT`),`LOSS_LOCATION_LONG` = as.double(`LOSS_LOCATION_LONG`),`CLAIM_AMOUNT` = as.double(`CLAIM_AMOUNT`),`FLAG_FOR_FRAUD_INV` = as.integer(`FLAG_FOR_FRAUD_INV`),`START_DATE` = as.Date(lubridate::parse_date_time(`START_DATE`, \"ymd\", quiet=TRUE)),`EXPIRY_DATE` = as.Date(lubridate::parse_date_time(`EXPIRY_DATE`, \"ymd\", quiet=TRUE)),`INITIAL_ODOMETER` = as.integer(`INITIAL_ODOMETER`),`LOW_MILEAGE_USE` = as.integer(`LOW_MILEAGE_USE`),`BIRTHDATE` = as.Date(lubridate::parse_date_time(`BIRTHDATE`, \"ymd\", quiet=TRUE)),`DRIVERS_LICENSE_EXPIRY` = as.Date(lubridate::parse_date_time(`DRIVERS_LICENSE_EXPIRY`, \"ymd\", quiet=TRUE)),`DATE_AT_CURRENT_ADDRESS` = as.Date(lubridate::parse_date_time(`DATE_AT_CURRENT_ADDRESS`, \"ymd\", quiet=TRUE)),`COMMUTE_DISCOUNT` = as.integer(`COMMUTE_DISCOUNT`))","args":{"type":"mutate","conditions":[],"auto":true,"autoConditions":[{"column":"INCIDENT_CAUSE","type":"as.integer","newColumnName":"","format":"","actualType":"character","removeColumn":false},{"column":"CLAIM_STATUS","type":"as.integer","newColumnName":"","format":"","actualType":"character","removeColumn":false},{"column":"ODOMETER_AT_LOSS","type":"as.double","newColumnName":"","format":"","actualType":"character","removeColumn":false},{"column":"LOSS_EVENT_TIME","type":"lubridate::mdy","newColumnName":"","format":"ymd","actualType":"character","removeColumn":false},{"column":"CLAIM_INIT_TIME","type":"lubridate::mdy","newColumnName":"","format":"ymd","actualType":"character","removeColumn":false},{"column":"POLICE_REPORT","type":"as.integer","newColumnName":"","format":"","actualType":"character","removeColumn":false},{"column":"CLAIMS_AT_LOSS_DATE","type":"as.integer","newColumnName":"","format":"","actualType":"character","removeColumn":false},{"column":"LOSS_LOCATION_LAT","type":"as.double","newColumnName":"","format":"","actualType":"character","removeColumn":false},{"column":"LOSS_LOCATION_LONG","type":"as.double","newColumnName":"","format":"","actualType":"character","removeColumn":false},{"column":"CLAIM_AMOUNT","type":"as.double","newColumnName":"","format":"","actualType":"character","removeColumn":false},{"column":"FLAG_FOR_FRAUD_INV","type":"as.integer","newColumnName":"","format":"","actualType":"character","removeColumn":false},{"column":"START_DATE","type":"lubridate::mdy","newColumnName":"","format":"ymd","actualType":"character","removeColumn":false},{"column":"EXPIRY_DATE","type":"lubridate::mdy","newColumnName":"","format":"ymd","actualType":"character","removeColumn":false},{"column":"INITIAL_ODOMETER","type":"as.integer","newColumnName":"","format":"","actualType":"character","removeColumn":false},{"column":"LOW_MILEAGE_USE","type":"as.integer","newColumnName":"","format":"","actualType":"character","removeColumn":false},{"column":"BIRTHDATE","type":"lubridate::mdy","newColumnName":"","format":"ymd","actualType":"character","removeColumn":false},{"column":"DRIVERS_LICENSE_EXPIRY","type":"lubridate::mdy","newColumnName":"","format":"ymd","actualType":"character","removeColumn":false},{"column":"DATE_AT_CURRENT_ADDRESS","type":"lubridate::mdy","newColumnName":"","format":"ymd","actualType":"character","removeColumn":false},{"column":"COMMUTE_DISCOUNT","type":"as.integer","newColumnName":"","format":"","actualType":"character","removeColumn":false}],"version":10}}},"parameters":{"FREEFORM_CODE":"mutate(`INCIDENT_CAUSE` = as.integer(`INCIDENT_CAUSE`),`CLAIM_STATUS` = as.integer(`CLAIM_STATUS`),`ODOMETER_AT_LOSS` = as.double(`ODOMETER_AT_LOSS`),`LOSS_EVENT_TIME` = stringToDateYMD(`LOSS_EVENT_TIME`),`CLAIM_INIT_TIME` = stringToDateYMD(`CLAIM_INIT_TIME`),`POLICE_REPORT` = as.integer(`POLICE_REPORT`),`CLAIMS_AT_LOSS_DATE` = as.integer(`CLAIMS_AT_LOSS_DATE`),`LOSS_LOCATION_LAT` = as.double(`LOSS_LOCATION_LAT`),`LOSS_LOCATION_LONG` = as.double(`LOSS_LOCATION_LONG`),`CLAIM_AMOUNT` = as.double(`CLAIM_AMOUNT`),`FLAG_FOR_FRAUD_INV` = as.integer(`FLAG_FOR_FRAUD_INV`),`START_DATE` = stringToDateYMD(`START_DATE`),`EXPIRY_DATE` = stringToDateYMD(`EXPIRY_DATE`),`INITIAL_ODOMETER` = as.integer(`INITIAL_ODOMETER`),`LOW_MILEAGE_USE` = as.integer(`LOW_MILEAGE_USE`),`BIRTHDATE` = stringToDateYMD(`BIRTHDATE`),`DRIVERS_LICENSE_EXPIRY` = stringToDateYMD(`DRIVERS_LICENSE_EXPIRY`),`DATE_AT_CURRENT_ADDRESS` = stringToDateYMD(`DATE_AT_CURRENT_ADDRESS`),`COMMUTE_DISCOUNT` = as.integer(`COMMUTE_DISCOUNT`))"},"inputs":[{"id":"inputPort1","links":[{"node_id_ref":"source1","port_id_ref":"source1output"}]}],"outputs":[{"id":"outputPort1"}]},{"id":"9cfa6da6-45d8-45cd-bbfd-cc65baed9877","type":"execution_node","op":"com.ibm.wdp.transformer.FreeformCode","app_data":{"uiParams":{"key":"extractDateTime","code":"mutate(`LOSS_EVENT_DAYS` = lubridate::yday(`LOSS_EVENT_TIME`))","args":{"column":"LOSS_EVENT_TIME","type":"yday","actualType":"Date","newColumnName":"LOSS_EVENT_DAYS","newColumnLocation":"none","version":1}}},"parameters":{"FREEFORM_CODE":"mutate(`LOSS_EVENT_DAYS` = dayofyear(`LOSS_EVENT_TIME`))"},"inputs":[{"id":"inputPort1","links":[{"node_id_ref":"dc18e187-5775-4045-8f8e-77100805c4eb","port_id_ref":"outputPort1"}]}],"outputs":[{"id":"outputPort2"}]},{"id":"df5d6ce9-a141-4e42-8bbd-c739a8017226","type":"execution_node","op":"com.ibm.wdp.transformer.FreeformCode","app_data":{"uiParams":{"key":"extractDateTime","code":"mutate(`EXPIRY_DAYS` = lubridate::yday(`EXPIRY_DATE`))","args":{"column":"EXPIRY_DATE","type":"yday","actualType":"Date","newColumnName":"EXPIRY_DAYS","newColumnLocation":"none","version":1}}},"parameters":{"FREEFORM_CODE":"mutate(`EXPIRY_DAYS` = dayofyear(`EXPIRY_DATE`))"},"inputs":[{"id":"inputPort1","links":[{"node_id_ref":"9cfa6da6-45d8-45cd-bbfd-cc65baed9877","port_id_ref":"outputPort2"}]}],"outputs":[{"id":"outputPort3"}]},{"id":"69192e2d-9763-4cef-bcdb-f60eb23bbde0","type":"execution_node","op":"com.ibm.wdp.transformer.FreeformCode","app_data":{"uiParams":{"key":"calculateNewColumn","code":"mutate(`SUSPICIOUS_CLAIM_FLAG` = `EXPIRY_DAYS`-`LOSS_EVENT_DAYS`)","args":{"column":"EXPIRY_DAYS","operator":"-","option":"column","dateTimeOption":"days","value":"LOSS_EVENT_DAYS","newColumnName":"SUSPICIOUS_CLAIM_FLAG","actualType":"Decimal","preserveDataTypeOption":false,"newColumnLocation":"none","version":1}}},"parameters":{"FREEFORM_CODE":"mutate(`SUSPICIOUS_CLAIM_FLAG` = `EXPIRY_DAYS`-`LOSS_EVENT_DAYS`)"},"inputs":[{"id":"inputPort1","links":[{"node_id_ref":"df5d6ce9-a141-4e42-8bbd-c739a8017226","port_id_ref":"outputPort3"}]}],"outputs":[{"id":"outputPort4"}]},{"id":"d40f3301-58ad-40fd-b4db-76cbf019c525","type":"execution_node","op":"com.ibm.wdp.transformer.FreeformCode","app_data":{"uiParams":{"key":"rename","code":"eval({if(!\"SUSPICIOUS_CLAIM_FLAG\" %in% names(.)) stop(\"'SUSPICIOUS_CLAIM_FLAG' not found.\", call. = FALSE) else .})%>%rename(`SUSPICIOUS_TIME` = `SUSPICIOUS_CLAIM_FLAG`)","args":{"column":"SUSPICIOUS_CLAIM_FLAG","newColumnName":"SUSPICIOUS_TIME"}}},"parameters":{"FREEFORM_CODE":"rename(`SUSPICIOUS_TIME` = `SUSPICIOUS_CLAIM_FLAG`)"},"inputs":[{"id":"inputPort1","links":[{"node_id_ref":"69192e2d-9763-4cef-bcdb-f60eb23bbde0","port_id_ref":"outputPort4"}]}],"outputs":[{"id":"outputPort5"}]},{"id":"c71f2da6-2ea1-4f94-8b5a-314a9816d6b0","type":"execution_node","op":"com.ibm.wdp.transformer.FreeformCode","app_data":{"uiParams":{"key":"conditionalReplace","code":"eval({if(!\"SUSPICIOUS_TIME\" %in% names(.)) stop(\"'SUSPICIOUS_TIME' not found.\", call. = FALSE) else .})%>%mutate(`SUSPICIOUS_CLAIM_FLAG` = case_when((`SUSPICIOUS_TIME`<0) ~ 1L, TRUE ~ 0L))","args":{"column":"SUSPICIOUS_TIME","columnActualType":"Decimal","conditions":[{"column":"SUSPICIOUS_TIME","actualType":"Decimal","operator":"<","value":"0","valueOption":"value","replaceValue":"1"}],"defaultReplaceValueOption":"value","defaultReplaceValue":"0","newColumnName":"SUSPICIOUS_CLAIM_FLAG","newColumnLocation":"none","version":1}}},"parameters":{"FREEFORM_CODE":"mutate(`SUSPICIOUS_CLAIM_FLAG` = case_when((`SUSPICIOUS_TIME`<0) ~ 1L, TRUE ~ 0L))"},"inputs":[{"id":"inputPort1","links":[{"node_id_ref":"d40f3301-58ad-40fd-b4db-76cbf019c525","port_id_ref":"outputPort5"}]}],"outputs":[{"id":"outputPort6"}]},{"id":"afa70516-64fb-4964-8fb0-a6bcab911e60","type":"execution_node","op":"com.ibm.wdp.transformer.FreeformCode","app_data":{"uiParams":{"key":"freeform-code","code":"mutate(provide_new_column = `LOSS_EVENT_TIME`>`DRIVERS_LICENSE_EXPIRY`)"}},"parameters":{"FREEFORM_CODE":"mutate(provide_new_column = `LOSS_EVENT_TIME`>`DRIVERS_LICENSE_EXPIRY`)"},"inputs":[{"id":"inputPort1","links":[{"node_id_ref":"c71f2da6-2ea1-4f94-8b5a-314a9816d6b0","port_id_ref":"outputPort6"}]}],"outputs":[{"id":"outputPort7"}]},{"id":"b894b103-07e6-4ed3-bad8-4306fc991332","type":"execution_node","op":"com.ibm.wdp.transformer.FreeformCode","app_data":{"uiParams":{"key":"mutate","code":"mutate(`provide_new_column` = as.integer(`provide_new_column`))","args":{"type":"mutate","conditions":[{"column":"provide_new_column","type":"as.integer","newColumnName":"","format":"","actualType":"Boolean","removeColumn":false,"newColumnLocation":"none","groupingMarker":""}],"auto":false,"autoConditions":[],"version":10}}},"parameters":{"FREEFORM_CODE":"mutate(`provide_new_column` = as.integer(`provide_new_column`))"},"inputs":[{"id":"inputPort1","links":[{"node_id_ref":"afa70516-64fb-4964-8fb0-a6bcab911e60","port_id_ref":"outputPort7"}]}],"outputs":[{"id":"outputPort8"}]},{"id":"cecd2e25-9fc0-4e42-923d-4ead1439d8d6","type":"execution_node","op":"com.ibm.wdp.transformer.FreeformCode","app_data":{"uiParams":{"key":"calculateNewColumn","code":"mutate(`EXCESSIVE_CLAIM_AMOUNT` = `CLAIM_AMOUNT`>10000)","args":{"column":"CLAIM_AMOUNT","operator":">","option":"value","dateTimeOption":"days","value":"10000","newColumnName":"EXCESSIVE_CLAIM_AMOUNT","actualType":"Decimal","preserveDataTypeOption":false,"newColumnLocation":"none","version":1}}},"parameters":{"FREEFORM_CODE":"mutate(`EXCESSIVE_CLAIM_AMOUNT` = `CLAIM_AMOUNT`>10000)"},"inputs":[{"id":"inputPort1","links":[{"node_id_ref":"b894b103-07e6-4ed3-bad8-4306fc991332","port_id_ref":"outputPort8"}]}],"outputs":[{"id":"outputPort9"}]},{"id":"ac94c9fb-f6b5-4e2b-baf0-77e89778bad4","type":"execution_node","op":"com.ibm.wdp.transformer.FreeformCode","app_data":{"uiParams":{"key":"mutate","code":"mutate(`EXCESSIVE_CLAIM_AMOUNT` = as.integer(`EXCESSIVE_CLAIM_AMOUNT`))","args":{"type":"mutate","conditions":[{"column":"EXCESSIVE_CLAIM_AMOUNT","type":"as.integer","newColumnName":"","format":"","actualType":"Boolean","removeColumn":false,"newColumnLocation":"none","groupingMarker":""}],"auto":false,"autoConditions":[],"version":10}}},"parameters":{"FREEFORM_CODE":"mutate(`EXCESSIVE_CLAIM_AMOUNT` = as.integer(`EXCESSIVE_CLAIM_AMOUNT`))"},"inputs":[{"id":"inputPort1","links":[{"node_id_ref":"cecd2e25-9fc0-4e42-923d-4ead1439d8d6","port_id_ref":"outputPort9"}]}],"outputs":[{"id":"outputPort10"}]},{"id":"target1","data_asset":{"properties":{"name":"AutoInsClaims_csv_shaped_shaped","file_format":"csv","mode":"overwrite","first_line_header":true},"app_data":{}},"type":"binding","input":{"id":"targetInput1","link":{"node_id_ref":"ac94c9fb-f6b5-4e2b-baf0-77e89778bad4","port_id_ref":"outputPort10"}}}],"runtime":"Spark"}]}}